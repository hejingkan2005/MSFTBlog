<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>Abstract base class over interface</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/Abhinaba Basu [MSFT]' target='_blank'>Abhinaba Basu [MSFT]</a>
<time>    2/13/2006 6:10:00 AM</time>
<hr>
<div id='content'><P>Currently I'm reading the book <A href="http://www.amazon.com/gp/product/0321246756/002-7692749-8100834?v=glance&amp;n=283155">Framework Design Guidelines</A>. This is one of the best books I have read in some time. Most books that cover design in general are one-sided and high-lights the author's beliefs and convictions. However, this book is very different. It gives suggestions about various framework design aspects and at the same time high-lights views/opinions of different people in the .NET team which doesn't necessarily conform to the guidelines. This makes the book a very interesting read. </P>
<P>One of the suggestions is "<EM>Favor defining classes over interface</EM>". While this is highly debatable, I agree to this in general. In this section I read a comment from Brian Pepin that reminded me of some framework code I saw long time back which convinced me that Abstract Base Classes are sometimes much superior to interfaces in defining contracts.</P>
<P>In that UI framework one of the requirements was that individual controls should support loading bitmaps that act as application skins with the following method prototypes....</P><PRE><FONT color=#0000ff size=2></FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName);<BR></FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, </FONT><FONT color=#008080 size=2>Color</FONT><FONT size=2> transparentCol);<BR></FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> width, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> height);<BR></FONT><STRONG><FONT color=#0000ff size=2>void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, </FONT><FONT color=#008080 size=2>Color</FONT></STRONG><STRONG><FONT size=2> transparentCol, <BR>                                 </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> width, </FONT><FONT color=#0000ff size=2>int</FONT></STRONG><FONT size=2><STRONG> height);</STRONG><P></P></FONT></PRE>
<P>The last method is the actual implementation and all the other methods&nbsp;fill in default values and passes it to this method. </P>
<P>In case this was defined in an interface as in </P><PRE><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>interface</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>ILoadBitmap<P></P></FONT><FONT size=2><P>{<BR></FONT><FONT color=#0000ff size=2>    void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName);<BR></FONT><FONT color=#0000ff size=2>    void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, </FONT><FONT color=#008080 size=2>Color</FONT><FONT size=2> transparentCol);<BR></FONT><FONT color=#0000ff size=2>    void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> width, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> height);<BR></FONT><FONT color=#0000ff size=2>    void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, </FONT><FONT color=#008080 size=2>Color</FONT><FONT size=2> transparentCol, <BR></FONT><FONT color=#0000ff size=2>                    int</FONT><FONT size=2> width, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> height);<BR>}</P></FONT></PRE>
<P>All classes that implemented the interface had to do method parameter validation for all the 4 methods and call the last method passing the default value for the parameters not specified. Not only this becomes tedious if some&nbsp;20 types of controls supported skinning, it leads to programmer error in which a wrong default value is passed in some of the controls. This is where Abstract Base Class comes in. Using ABC you can code this as </P><PRE><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>abstract</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>SkinControl<P></P></FONT><FONT size=2><P>{<BR></FONT><FONT color=#0000ff size=2>    public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName)<BR><FONT color=#0000ff>    </FONT>{<BR></FONT><FONT color=#008080 size=2><FONT color=#0000ff>        </FONT>Debug</FONT><FONT size=2>.Assert(!</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.IsNullOrEmpty(fileName));<BR><FONT color=#0000ff>        </FONT>LoadBitmap(fileName, </FONT><FONT color=#008080 size=2>Color</FONT><FONT size=2>.Magenta, -1, -1);<BR><FONT color=#0000ff>    </FONT>}<BR></FONT><FONT color=#0000ff size=2>    public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, </FONT><FONT color=#008080 size=2>Color</FONT><FONT size=2> transparentCol)<BR><FONT color=#0000ff>    </FONT>{<BR></FONT><FONT color=#008080 size=2><FONT color=#0000ff>        </FONT>Debug</FONT><FONT size=2>.Assert(!</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.IsNullOrEmpty(fileName));<BR><FONT color=#0000ff>        </FONT>LoadBitmap(fileName, transparentCol, -1, -1);<BR><FONT color=#0000ff>    </FONT>}<BR></FONT><FONT color=#0000ff size=2>    public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> width, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> height)<BR><FONT color=#0000ff>    </FONT>{<BR></FONT><FONT color=#008080 size=2><FONT color=#0000ff>        </FONT>Debug</FONT><FONT size=2>.Assert(!</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.IsNullOrEmpty(fileName));<BR></FONT><FONT color=#008080 size=2><FONT color=#0000ff>        </FONT>Debug</FONT><FONT size=2>.Assert(width &gt; 0 &amp;&amp; height &gt; 0);<BR><FONT color=#0000ff>        </FONT>LoadBitmap(fileName, </FONT><FONT color=#008080 size=2>Color</FONT><FONT size=2>.Magenta, width, height);<BR><FONT color=#0000ff>    </FONT>}<BR></FONT><FONT color=#0000ff size=2>    public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>abstract</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, <BR><FONT color=#0000ff>                                    </FONT></FONT><FONT color=#008080 size=2>Color</FONT><FONT size=2> transparentCol,<BR></FONT><FONT color=#0000ff size=2>                                    int</FONT><FONT size=2> width, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> height);<BR>}<BR></FONT><FONT color=#0000ff size=2><BR>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>SkinnedButton</FONT><FONT size=2> : </FONT><FONT color=#008080 size=2>SkinControl</P></FONT><FONT size=2><P>{<BR></FONT><FONT color=#0000ff size=2>    public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> LoadBitmap(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> fileName, <BR>                                    </FONT><FONT color=#008080 size=2>Color</FONT><FONT size=2> transparentCol, <BR>                                    </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> width, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> height)<BR><FONT color=#0000ff>    </FONT>{<BR><FONT color=#008000>        <STRONG>// Actual implementation</STRONG> </FONT><BR><BR><BR><FONT color=#0000ff>    </FONT>}<BR>}</P></FONT></PRE>
<P>All the methods are implemented in the ABC and only the last method is made abstract. So for all classes that implements this abstract class the developer needs to implement the fourth overload of the method only. Most of the contract is directly coded into the ABC. This results in less code and less programming error.</P></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
